<script src="public/external/momentjs/moment.min.js"></script>

<div id="highlights">
  <img src="{publiclink}{raw}highlights_image{raw}{publiclink}" width="940" height="285" />
</div>

<div class="row">
  <div id="maincontainer" class="span9">
    <div id="maincontent">
      <h1>{lang}partner_title{lang}</h1>

      {widget}message_stack|partner{widget}

      <p>{lang}partner_introduction{lang}</p>

{loop partner_campaigns}
      <div id="partnerc_#code#">
        <p class="pcdate label pull-right">%date_end%</p>
        <p><a href="{link}Account|Website|Partner&Edit=%code%|SSL{link}">#title#</a> <small>(in %category_title%)</small><br /><span class="pcdays muted"></span></p>
      </div>
{loop}

      <p align="center"><small class="text-success">{lang}partner_multiple_discount_info{lang}</small></p>

<script>
var partner_date_now = moment('{value addslashes}partner_date_now{value}');

$(function() {
  $('[id^=partnerc_]').each(function() {
    var runsUntil = moment($('.pcdate', this).text());

    $('.pcdate', this).text(runsUntil.format('Do MMM, YYYY'));

    if ( runsUntil.isBefore(partner_date_now) ) {
      $('.pcdate', this).addClass('label-important');

      $('.pcdays', this).html('<small>(' + partner_date_now.diff(runsUntil, 'days') + ' days ago)</small>');
    } else {
      $('.pcdate', this).addClass('label-success');

      $('.pcdays', this).html('<small>(' + runsUntil.diff(partner_date_now, 'days') + ' days remaining)</small>');
    }
  });
});
</script>

    </div>
  </div>

  {widget}account_sidebar_nav{widget}
</div>
