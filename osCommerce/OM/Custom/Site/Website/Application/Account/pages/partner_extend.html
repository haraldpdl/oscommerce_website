<div id="highlights">
  {raw}partner_header{raw}
</div>

<div class="row">
  {widget}account_sidebar_nav{widget}

  <div id="maincontainer" class="col-sm-9 col-sm-pull-3">
    <div id="maincontent">
      <div class="pull-right"><span class="pcdate label">{value}partner_campaign date_end{value}</span><br /><span class="pcdays text-muted small"></span></div>

      <h1>{value}partner_campaign title{value}</h1>

      {widget}message_stack|partner{widget}

      <h2>{lang}partner_extension_title{lang}</h2>

      <p>{lang}partner_extension_description{lang}</p>

      <div class="col-xs-6">
        <div class="panel panel-info">
          <div class="panel-heading text-center">
            <h3 class="panel-title">{lang}cs_plans_title_silver{lang}</h3>
          </div>

          <div class="panel-body">
            <table class="table table-hover table-borderless">
              <tbody>
                <tr>
                  <td>{lang}cs_plans_service_partner{lang}</td>
                  <td align="center"><i class="fa fa-check-square" style="color: #5bc0de; font-size: 1.6em;"></i></td>
                </tr>
                <tr>
                  <td>{lang}cs_plans_service_information_page{lang}</td>
                  <td align="center"><i class="fa fa-check-square" style="color: #5bc0de; font-size: 1.6em;"></i></td>
                </tr>
                <tr>
                  <td>{lang}cs_plans_service_commercial_inquiries{lang}</td>
                  <td align="center"><i class="fa fa-check-square" style="color: #5bc0de; font-size: 1.6em;"></i></td>
                </tr>
                <tr>
                  <td>{lang}cs_plans_service_commercial_feedback{lang}</td>
                  <td align="center"><i class="fa fa-check-square" style="color: #5bc0de; font-size: 1.6em;"></i></td>
                </tr>
                <tr>
                  <td>{lang}cs_plans_service_profile{lang}</td>
                  <td align="center"><i class="fa fa-check-square" style="color: #5bc0de; font-size: 1.6em;"></i></td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="panel-footer text-center" style="border-top: none; background: none;">
            <form class="form-inline">
              <div class="form-group">
                <select class="form-control" id="pSilverPlan">
                  <option value="0">{lang}cs_pricing_please_select{lang}</option>
                  <option value="1">{lang}cs_pricing_1_month{lang} 50 €</option>
                  <option value="3">{lang}cs_pricing_3_months{lang} 140 €</option>
                  <option value="6">{lang}cs_pricing_6_months{lang} 250 €</option>
                  <option value="12">{lang}cs_pricing_12_months{lang} 500 €</option>
                </select>
              </div>

              <button id="pSilver" class="btn btn-info paypal-button-hidden">{lang}cs_purchase_button{lang}</button>
            </form>
          </div>
        </div>
      </div>

      <div class="col-xs-6">
        <div class="panel panel-success">
          <div class="panel-heading text-center">
            <h3 class="panel-title">{lang}cs_plans_title_gold{lang}</h3>
          </div>

          <div class="panel-body">
            <table class="table table-hover table-borderless">
              <tbody>
                <tr>
                  <td>{lang}cs_plans_service_silver_level{lang}</td>
                  <td align="center"><i class="fa fa-check-square" style="color: #5cb85c; font-size: 1.6em;"></i></td>
                </tr>
                <tr>
                  <td>{lang}cs_plans_service_custom_header{lang}</td>
                  <td align="center"><i class="fa fa-check-square" style="color: #5cb85c; font-size: 1.6em;"></i></td>
                </tr>
                <tr>
                  <td>{lang}cs_plans_service_promotions{lang}</td>
                  <td align="center"><i class="fa fa-check-square" style="color: #5cb85c; font-size: 1.6em;"></i></td>
                </tr>
                <tr>
                  <td>{lang}cs_plans_service_banner{lang}</td>
                  <td align="center"><i class="fa fa-check-square" style="color: #5cb85c; font-size: 1.6em;"></i></td>
                </tr>
                <tr>
                  <td>{lang}cs_plans_service_adwords{lang}</td>
                  <td align="center"><i class="fa fa-check-square" style="color: #5cb85c; font-size: 1.6em;"></i></td>
                </tr>
                <tr>
                  <td>{lang}cs_plans_service_forum_channel{lang}</td>
                  <td align="center"><i class="fa fa-check-square" style="color: #5cb85c; font-size: 1.6em;"></i></td>
                </tr>
                <tr>
                  <td>{lang}cs_plans_service_news_publishing{lang}</td>
                  <td align="center"><i class="fa fa-check-square" style="color: #5cb85c; font-size: 1.6em;"></i></td>
                </tr>
                <tr>
                  <td>{lang}cs_plans_service_showcase_sites{lang}</td>
                  <td align="center"><i class="fa fa-check-square" style="color: #5cb85c; font-size: 1.6em;"></i></td>
                </tr>
              </tbody>
            </table>
          </div>

          <div class="panel-footer text-center" style="border-top: none; background: none;">
            <form class="form-inline">
              <div class="form-group">
                <select class="form-control" id="pGoldPlan">
                  <option value="0">{lang}cs_pricing_please_select{lang}</option>
                  <option value="1">{lang}cs_pricing_1_month{lang} 100 €</option>
                  <option value="3">{lang}cs_pricing_3_months{lang} 280 €</option>
                  <option value="6">{lang}cs_pricing_6_months{lang} 500 €</option>
                  <option value="12">{lang}cs_pricing_12_months{lang} 1,000 €</option>
                </select>
              </div>

              <button id="pGold" class="btn btn-success paypal-button-hidden">{lang}cs_purchase_button{lang}</button>
            </form>
          </div>
        </div>
      </div>

      <div class="clearfix"></div>

      <p class="text-center"><small class="text-muted">{lang}cs_pricing_info{lang}</small></p>

      <h3>{lang}partner_extension_after_payment_title{lang}</h3>

      {lang}partner_extension_after_payment_description{lang}
    </div>
  </div>
</div>

<script>
window.paypalCheckoutReady = function() {
  paypal.checkout.setup('{value}paypal_merchant_id{value}', {
    environment: '{value}paypal_server{value}' != 'live' ? 'sandbox' : 'production',
    button: ['pSilver', 'pGold'],
    click: function(e) {
      e.preventDefault();

      var p = {};

      if (e.target.id == 'pGold') {
        p.plan = 'gold';
      } else {
        p.plan = 'silver';
      }

      p.duration = $('#' + e.target.id + 'Plan').val();

      if ($.inArray(p.duration, ['1', '3', '6', '12']) === -1) {
        $('#p' + (p.plan == 'gold' ? 'Gold' : 'Silver') + 'Plan').closest('.form-group').addClass('has-error');

        toastr.error('There was a problem with the duration of the selected plan. Please try again.');

        return false;
      }

      if ($('#pSilverPlan, #pGoldPlan').closest('.form-group').hasClass('has-error')) {
        $('#pSilverPlan, #pGoldPlan').closest('.form-group').removeClass('has-error');
      }

      toastr.remove();

      paypal.checkout.initXO();

      var ppCall = $.post('{raw addslashes}payment_init_url{raw}', p, null, 'json');

      ppCall.done(function (data) {
        if (typeof data.token !== 'undefined') {
          paypal.checkout.startFlow('https://www.' + ('{value}paypal_server{value}' != 'live' ? 'sandbox.' : '') + 'paypal.com/checkoutnow?useraction=commit&token=' + data.token);
        }
      });

      ppCall.fail(function () {
        paypal.checkout.closeFlow();
      });
    }
  });
};

$(function() {
  var highestBox = 0;

  $('#maincontent .panel .panel-body').each(function() {
    if ($(this).height() > highestBox) {
      highestBox = $(this).height();
    }
  });

  $('#maincontent .panel .panel-body').height(highestBox);

  var partner_date_now = moment('{value addslashes}partner_date_now{value}');
  var runsUntil = moment($('.pcdate').text());

  $('.pcdate').text(runsUntil.format('Do MMM, YYYY'));

  if (runsUntil.isBefore(partner_date_now)) {
    $('.pcdate').addClass('label-danger');

    $('.pcdays').html(runsUntil.from(partner_date_now));
  } else {
    var daysRemaining = runsUntil.diff(partner_date_now, 'days');

    $('.pcdays').html(partner_date_now.to(runsUntil));

    if ( daysRemaining > 14 ) {
      $('.pcdate').addClass('label-success');
    } else {
      $('.pcdate').addClass('label-warning');
    }
  }
});
</script>

<script src="public/external/momentjs/moment.min.js"></script>

<script src="https://www.paypalobjects.com/api/checkout.js" async></script>
