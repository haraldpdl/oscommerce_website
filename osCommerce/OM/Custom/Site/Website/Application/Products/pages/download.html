<div class="row">
  <div class="col-xs-12">
    <div class="jumbotron">
      <h2>{lang}download_title{lang}</h2>

      <p>{lang}download_description{lang}</p>

      <form id="downloadForm" action="{link}Products|Website|Download={get}Download{get}{link}" method="post">
        <input type="hidden" name="get" value="{get}Download{get}" />
        <input type="hidden" name="do" value="1" />
        <button type="submit" class="btn btn-info btn-lg">{lang}download_now_button{lang}</button>
      </form>
    </div>
  </div>
</div>

<div class="row">
  <div id="maincontainer" class="col-xs-12">
    <div id="maincontent" class="noborder">
      <h2>{lang}partner_promotions_heading{lang}</h2>

      <div>
        <select id="partnerPromotionFilter">
          <option value="All">{lang}partner_promotions_show_all{lang}</option>

{loop partner_promotion_categories}
          <option value="#code#">#title#</option>
{loop}

        </select>
      </div>

      <div id="partnerPromotionContainer">

{loop partner_promotions}
        <div class="partnerPromotionCategory_#category_code#" style="float: left; text-align: center; padding: 30px;"><a href="#image_promo_url#" target="_blank"><img src="{publiclink}images/partners/%image_promo%{publiclink}" alt="" title="#title#" width="150" height="100" /></a><br /><span class="label label-warning">#category_title#</span></div>
{loop}

        <div class="clearfix"></div>
      </div>
    </div>
  </div>
</div>

<script>
$(function() {
  $('#partnerPromotionFilter').change(function() {
    if ( this.value == 'All' ) {
      $('[class^="partnerPromotionCategory_"]').fadeIn('fast');
    } else {
      var selected = this;

      $('#partnerPromotionContainer').css('minHeight', $('#partnerPromotionContainer').height());

      $('[class^="partnerPromotionCategory_"]').fadeOut('fast').promise().done(function() {
        $('.partnerPromotionCategory_' + selected.value).fadeIn('fast');
        $('#partnerPromotionContainer').css('minHeight', '');
      });
    }
  });

  var redirect_count = 5;
  var redirect_timer = setInterval(function() {
    if ( --redirect_count < 1 ) {
      clearInterval(redirect_timer);
      $('#downloadForm').submit();
    }

    $('#redirect_counter').text(redirect_count);
  }, 1000);

  $('#downloadForm').submit(function() {
    clearInterval(redirect_timer);
    $('#redirect_counter').text(0);
  });
});
</script>
